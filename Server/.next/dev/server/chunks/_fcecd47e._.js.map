{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/monalisasabina/AI_CODE_CLASS/crochet-order-manager/Server/lib/prisma.ts"],"sourcesContent":["import \"dotenv/config\";\nimport { PrismaBetterSqlite3 } from \"@prisma/adapter-better-sqlite3\";\nimport { PrismaClient } from \"../generated/prisma/client\";\n\nconst connectionString = `${process.env.DATABASE_URL}`;\n\nconst adapter = new PrismaBetterSqlite3({ url: connectionString });\nconst prisma = new PrismaClient({ adapter });\n\nexport default prisma ;"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,mMAAmB,CAAC;IAAE,KAAK;AAAiB;AAChE,MAAM,SAAS,IAAI,+IAAY,CAAC;IAAE;AAAQ;uCAE3B"}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///home/monalisasabina/AI_CODE_CLASS/crochet-order-manager/Server/app/api/orders/route.js"],"sourcesContent":["import prisma from '../../../lib/prisma';\nimport {NextResponse} from 'next/server';\n\n// CORS HEADERS\nconst corsHeaders ={\n    'Access-Control-Allow-Origin': 'http://localhost:4000',\n    'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\n    'Access-Control-Allow-Headers': 'Content-Type, Authorization',\n}\n\n//Preflight request handler\nexport async function OPTIONS() {\n    return new NextResponse(null, {\n        status: 200,\n        headers: corsHeaders\n    });\n}\n\n\n\n// GET ALL THE ORDERS\nexport async function GET() {\n    try{\n        const orders = await prisma.order.findMany({\n            include:{\n                client: {\n                    select: {\n                        id: true,\n                        firstName: true,\n                        lastName: true,\n                   }\n               }\n            }\n        });\n\n        console.log('Fetched orders:', orders);\n        return NextResponse.json(orders, {\n                                           status: 200 \n                                        , headers: corsHeaders });\n    }catch (error) {\n        console.error('Error fetching orders:', error);\n        return NextResponse.json(\n            { error: 'Failed to fetch orders' }, \n            { status: 500, headers: corsHeaders }); \n    }\n}\n\n// CREATE A NEW ORDER\nexport async function POST(request) {\n    try {\n        // Extract client data from the request body\n        const { title, imageUrl, endDate, clientId } = await request.json();\n\n        const newOrder = await prisma.order.create({\n            data: {\n                title, \n                imageUrl, \n                endDate: new Date(endDate), \n                clientId: parseInt(clientId)},\n        });\n\n        console.log('Created new order:', newOrder);\n\n        // Creating notification\n        const orderNotification = await prisma.notification.create({\n            data: {\n                message: `Order \"${newOrder.title}\" created for client ID ${newOrder.clientId}.`,\n                isRead: false,\n            }\n        });\n        console.log(\"Created notification:\", orderNotification)\n\n        return NextResponse.json(\n            {order: newOrder, notification: orderNotification}, \n            { status: 201, headers: corsHeaders });\n\n    } catch (error) {\n        console.error('Error creating order:', error);\n        return NextResponse.json(\n            { error: 'Failed to create order' },\n            { status: 500, headers: corsHeaders });\n    }\n}\n\n"],"names":[],"mappings":";;;;;;;;AAAA;AACA;;;AAEA,eAAe;AACf,MAAM,cAAa;IACf,+BAA+B;IAC/B,gCAAgC;IAChC,gCAAgC;AACpC;AAGO,eAAe;IAClB,OAAO,IAAI,gJAAY,CAAC,MAAM;QAC1B,QAAQ;QACR,SAAS;IACb;AACJ;AAKO,eAAe;IAClB,IAAG;QACC,MAAM,SAAS,MAAM,0HAAM,CAAC,KAAK,CAAC,QAAQ,CAAC;YACvC,SAAQ;gBACJ,QAAQ;oBACJ,QAAQ;wBACJ,IAAI;wBACJ,WAAW;wBACX,UAAU;oBACf;gBACJ;YACH;QACJ;QAEA,QAAQ,GAAG,CAAC,mBAAmB;QAC/B,OAAO,gJAAY,CAAC,IAAI,CAAC,QAAQ;YACE,QAAQ;YACT,SAAS;QAAY;IAC3D,EAAC,OAAO,OAAO;QACX,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAyB,GAClC;YAAE,QAAQ;YAAK,SAAS;QAAY;IAC5C;AACJ;AAGO,eAAe,KAAK,OAAO;IAC9B,IAAI;QACA,4CAA4C;QAC5C,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEjE,MAAM,WAAW,MAAM,0HAAM,CAAC,KAAK,CAAC,MAAM,CAAC;YACvC,MAAM;gBACF;gBACA;gBACA,SAAS,IAAI,KAAK;gBAClB,UAAU,SAAS;YAAS;QACpC;QAEA,QAAQ,GAAG,CAAC,sBAAsB;QAElC,wBAAwB;QACxB,MAAM,oBAAoB,MAAM,0HAAM,CAAC,YAAY,CAAC,MAAM,CAAC;YACvD,MAAM;gBACF,SAAS,CAAC,OAAO,EAAE,SAAS,KAAK,CAAC,wBAAwB,EAAE,SAAS,QAAQ,CAAC,CAAC,CAAC;gBAChF,QAAQ;YACZ;QACJ;QACA,QAAQ,GAAG,CAAC,yBAAyB;QAErC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAC,OAAO;YAAU,cAAc;QAAiB,GACjD;YAAE,QAAQ;YAAK,SAAS;QAAY;IAE5C,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAyB,GAClC;YAAE,QAAQ;YAAK,SAAS;QAAY;IAC5C;AACJ"}}]
}