{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/monalisasabina/AI_CODE_CLASS/crochet-order-manager/Server/lib/prisma.ts"],"sourcesContent":["import \"dotenv/config\";\nimport { PrismaBetterSqlite3 } from \"@prisma/adapter-better-sqlite3\";\nimport { PrismaClient } from \"../generated/prisma/client\";\n\nconst connectionString = `${process.env.DATABASE_URL}`;\n\nconst adapter = new PrismaBetterSqlite3({ url: connectionString });\nconst prisma = new PrismaClient({ adapter });\n\nexport default prisma ;"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,mMAAmB,CAAC;IAAE,KAAK;AAAiB;AAChE,MAAM,SAAS,IAAI,+IAAY,CAAC;IAAE;AAAQ;uCAE3B"}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file:///home/monalisasabina/AI_CODE_CLASS/crochet-order-manager/Server/app/api/admins/%5Bid%5D/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport prisma from '../../../../lib/prisma';\nimport bcrypt from 'bcryptjs';\n\n// HELPER FUNCTIONS------------------------------------\n// Get Admin ID from request URL\nfunction getAdminId(request){\n    const id = request.url.split(\"/\").pop();\n\n    const adminId = Number(id);\n    return isNaN(adminId) ? null : adminId;\n}\n\n// Invalid admin ID response\nfunction invalidResponse(request){\n    return NextResponse.json(\n        { error: \"Invalid admin ID\" },\n        { status: 400 }\n    )\n}\n\n// CRUD METHODS---------------------------------------\n// FETCHING A SINGLE ADMIN BY ID\nexport async function GET(request) {\n\n    try{\n    // Extracting admin ID from the URL parameters\n    const adminId = getAdminId(request);\n    \n    // Validating admin ID\n    if (!adminId) return invalidResponse();\n    \n    // Fetching the admin by ID from the database\n    const admin = await prisma.admin.findUnique({\n        where: { id: Number(adminId) },\n    });\n\n    if (!admin) {\n        return NextResponse.json(\n            { error: 'Admin not found' },\n            { status: 404 }\n        );\n    }\n\n    // Returning response \n    return NextResponse.json(admin, { status: 200 });\n    } catch (error) {\n        console.error('Error fetching admin by ID:', error);\n        return NextResponse.json({ error: 'Failed to fetch admin' }, { status: 500 });\n    }\n\n}\n\n// UPDATE AN EXISTING ADMIN CREDENTIALS\nexport async function PATCH(request) {\n    try {\n        // Extracting client ID from the URL parameters\n        const id = getAdminId(request);\n        console.log('Admin ID to update:', id);\n\n        // Validating admin ID\n        if (!id) return invalidResponse();\n\n        // Extracting updated data from the request body\n        const { firstName, lastName, userName, email, password } = await request.json();\n\n        // Preparing data object for update\n        const dataToUpdate = { firstName, lastName, userName, email };\n\n        // If password is provided, hash it before updating\n        if (password) {\n            \n            const hashedPassword = await bcrypt.hash(password, 10);\n            dataToUpdate.password = hashedPassword;\n        }\n\n        // Updating the admin in the database\n        const updatedAdmin = await prisma.admin.update({\n            where: { id: Number(id) },\n            data: dataToUpdate,\n        });\n\n        console.log('Updated admin:', updatedAdmin);\n\n        return NextResponse.json(updatedAdmin, { status: 200 });\n\n    } catch (error) {\n        console.error('Error updating admin:', error);\n        return NextResponse.json({ error: 'Failed to update admin' }, { status: 500 });\n    }\n}\n\n// DELETE AN ADMIN BY ID\nexport async function DELETE(request) {\n    try {\n        const adminId = getAdminId(request);\n\n        // Validating admin ID\n        if (!adminId) return invalidResponse();\n\n        const deletedAdmin = await prisma.admin.delete({\n            where: { id: Number(adminId) },\n        });\n        \n        // STRIPPING PASSWORD BEFORE SENDING RESPONSE\n        const { password: _, ...adminWithoutPassword } = deletedAdmin;\n\n      \n        // console.log('Deleted admin:', deletedAdmin);\n\n        return NextResponse.json(adminWithoutPassword, { status: 200 });\n    } catch (error) {\n        if (error.code === 'P2025') {\n            return NextResponse.json(\n                { error: 'Admin not found' },\n                { status: 404 }\n            );\n        }\n        console.error('Error deleting admin:', error);\n        return NextResponse.json({ error: 'Failed to delete admin' }, { status: 500 });\n    }\n}"],"names":[],"mappings":"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"}}]
}